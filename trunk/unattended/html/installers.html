<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Unattended/Silent Installer Switches for Windows Apps</title>
</head>
<body>

<p>This document is part of <a
href="http://unattended.sourceforge.net/"
>http://unattended.sourceforge.net/</a>.

<hr>
<h1>Introduction</h1>

<p>The goal of this page is to collect instructions for performing
unattended/silent installations of many popular Windows applications.
Such instructions are useful for people who wish to automate these
installations.

<p>A quick word on terminology: Strictly speaking, an
<em>unattended</em> installation is one which does not require user
interaction, and a <em>silent</em> (or <em>quiet</em>) installation is
one which does not display any indication of its progress.  However,
most vendors treat these words as synonyms.

<p>In this document, we are interested not only in unattended
installations, but also in being able to wait for the installation to
finish and to suppress any automatic reboot.  These are both necessary
for creating a system to <a href="apps.html">reliably install multiple
applications.</a>

<h1>General information</h1>

<p>There are several installer packages in common use in the Windows
World.  Sometimes it will be obvious from the splash screen which one
is in use; sometimes you can figure it out by running the Unix
"strings" utility; and sometimes you just have to guess.

<h2>MSI packages</h2>

<p>Microsoft's own <a
href="http://www.microsoft.com/windows2000/techinfo/howitworks/management/installer.asp">Windows
Installer Service</a> is the standard, and if everybody used it, there
would be no need for this document.

<p>The package files have a <kbd>.msi</kbd> extension, and you
manipulate them using the <a
href="http://www.microsoft.com/TechNet/prodtechnol/winxppro/proddocs/msiexec.asp"
><kbd>msiexec</kbd></a> utility.

<p>For installation, use the <kbd>/i</kbd> and <kbd>/qb</kbd> flags.
Use the <kbd>/l*</kbd> option to produce a log file.  You may provide
options at the end of the command line; which options are supported
depends on the package.  For example, this command:

<pre>
    msiexec /qb /l* perl-log.txt /i ActivePerl.msi PERL_PATH=Yes PERL_EXT=Yes
</pre>

...is how you install ActiveState Perl, instructing the MSI package to
add Perl.exe to your PATH and to associate .pl files with it (<a
href="#activeperl">See below</a> for more on Perl).

<p><kbd>msiexec</kbd> can do many other things, like uninstall
software or apply patches to existing MSI files.  Neat, huh?  Too bad
nobody uses it.

<h2 id="installshield">InstallShield</h2>

<p><a href="http://www.installshield.com/">InstallShield</a> is one of
the oldest and most widely used application packaging utilities.

<p>Installers created by InstallShield generally recognize the
<kbd>/r</kbd>, <kbd>/s</kbd>, <kbd>/sms</kbd>, and <kbd>/f1</kbd>
flags.

<p>To perform a "silent" installation, you need a <em>setup.iss</em>
file.  Some applications ship with such a file, but if yours does not,
you can use the graphical installer itself to create one.

<p>Here's how it works.  Run the installer with the <kbd>/r</kbd>
("record") option.  Proceed through the dialogs and complete the
installation.  This will create a <em>setup.iss</em> file and place it
in the <em>C:\WINNT</em> directory (yes, really).  This file will
include all of your answers to the InstallShield dialogs, allowing you
to perform unattended installations giving the same answers.  Simply
copy <em>setup.iss</em> to the same directory as the installer.

<p>Once you have a <em>setup.iss</em> file, you can run the installer
with the <kbd>/s</kbd> ("silent") option.  This will perform an
unattended installation.

<p>Unfortunately, the installer will fork a separate process and exit,
meaning it will return immediately even if you run it with
<kbd>start&nbsp;/wait</kbd>.  Luckily, there is another option,
<kbd>/sms</kbd>, which will cause the installer to pause until the
installation completes.

<p>Hence, for an InstallShield app, you want to provide the
<kbd>/s</kbd> and <kbd>/sms</kbd> switches.

<p>The <kbd>/f1</kbd> switch allows you to specify a path to the
<em>setup.iss</em> file.  I assume this is to let you support multiple
configurations for a single application.

<p>Oh, one more thing.  The <kbd>/r</kbd> switch only works if the
vendor is competent.  Many vendors add "custom dialogs" to their
InstallShield packages and do not bother to support them in
<em>setup.iss</em> files, which means those dialogs will always appear
no matter what you do.  For such vendors, I suggest asking them to fix
their installers, and if that does not work, doing what you can to
help them go out of business.

<h2 id="wise">Wise InstallMaster</h2>

<p>InstallMaster from <a href="http://www.wise.com/">Wise
Solutions</a> is a competitor to InstallShield.  You can usually
identify the installers it produces by running "strings" on the
executable and grepping for "Wise".

<p>InstallMaster installers are supposed to recognize the
<kbd>/s</kbd> switch to perform a silent installation.  And in my
experience, they generally do.  There is no way to set options.

<p>NOTE: This product has been rebranded the "Wise Installation
System".  Don't let them confuse you.

<h2="inno">Inno Setup</h2>

<p><a href="http://www.jrsoftware.org/isinfo.php">Inno Setup</a> is an
open source competitor in this space.  You can usually identify the
installers it creates by running "strings" on the executable and
grepping for "Inno".

<p>Inno Setup installers recognize the <kbd>/silent</kbd> option.

<h1>Specific applications</h1>

<br><hr width="50%">
<h2 id="acrobat-reader">Acrobat Reader</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a href="http://www.adobe.com/products/acrobat/readstep.html">Free
Download</a>
<tr><td valign="middle">Details
<td><p>This one is tricky.

<p>Download the full installer package from Adobe.  Start it up.  It
will extract itself to a temporary folder in your profile, probably
somewhere like
<kbd>C:\Program&nbsp;Files\Documents&nbsp;and&nbsp;Settings\Administrator\Local&nbsp;Settings\Temp</kbd>.
But the installer will delete the temporary folder when it is
finished, so do
<b>not</b> complete the installation.  Instead, copy the temporary
folder somewhere else while the installer is running.

<p>This temporary folder is just a copy of the Acrobat Reader CD-ROM;
this is our installation tree.  From here, you can follow the
instructions in Adobe's <a
href="http://www.adobe.com/support/techdocs/2cc1e.htm">"Using a
setup.iss file for a Silent Installation of Acrobat Reader in
Windows"</a> document.  It is an <a href="#installshield"
>InstallShield</a> app.

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/acrobat-reader.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">acrobat-reader.bat</a>

</table>

<br><hr width="50%">
<h2 id="activeperl">ActiveState Perl (ActivePerl)</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a href="http://www.activestate.com/Products/ActivePerl/">Open Source</a>
<tr><td valign="middle">Details
<td><p>Just download the MSI file.

<p>Most of the options are <a
href="http://aspn.activestate.com/ASPN/Perl/Reference/Products/ActivePerl/install.html#windows%20installers"
>documented</a>, except for <kbd>PERL_EXT</kbd>, which tells the
installer to make ActivePerl the default handler for .pl files (highly
recommended).

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/perl.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">perl.bat</a>

</table>

<br><hr width="50%">
<h2 id="att-global-dialer">AT&amp;T Global Network Dialer</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><ahref="http://help.attbusiness.net/">Free Download</a> (but
requires the service)

<tr><td valign="middle">Details

<td><p>The downloaded installer is named <kbd>ncsetup.exe</kbd>; you
probably want to rename it to <kbd>att-5.0.5.exe</kbd> or somesuch.
Running "strings" on the executable reveals that it was created by <a
href="#wise">Wise Installmaster</a>, so the <kbd>/s</kbd> flag will do
the trick.

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/att.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">att.bat</a>

</table>

<br><hr width="50%">
<h2 id="directx">DirectX 8.1</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a
href="http://www.microsoft.com/windows/directx/downloads/drx81.asp"
>Free Download</a>
<tr><td valign="middle">Details

<td><p>The downloaded installer is named DX81NTeng.exe.  Run
<kbd>DX81NTeng.exe&nbsp;/c&nbsp;/t:<var>path</var></kbd> to extract
the tree to <var>path</var>.  From that tree, run
<kbd>dxsetup&nbsp;/silent&nbsp;/install</kbd>.

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/directx81.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">directx81.bat</a>

</table>

<hr>
<address>
Patrick J. LoPresti <a
href="mailto:patl@users.sourceforge.net">patl@users.sourceforge.net</a>
</address>
</body>
</html>
