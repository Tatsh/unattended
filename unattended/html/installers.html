<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Unattended/Silent Installer Switches for Windows Apps</title>
</head>
<body>

<p>This document is part of <a
href="http://unattended.sourceforge.net/"
>http://unattended.sourceforge.net/</a>.

<hr>
<h1>Introduction</h1>

<p>The goal of this document is to collect instructions for performing
unattended/silent installations of many popular Windows applications.
Such instructions are useful for automating these installations.

<p>A quick word on terminology: Strictly speaking, an
<em>unattended</em> installation is one which does not require user
interaction, and a <em>silent</em> (or <em>quiet</em>) installation is
one which does not display any indication of its progress.  However,
most vendors treat these words as synonyms.

<p>Here, we are interested not only in unattended installations, but
also in waiting for the installation to finish and suppressing any
automatic reboot.  These are both necessary to create a system for <a
href="apps.html">reliably installing multiple applications</a>.

<hr>
<h1>General information</h1>

<p>There are several utilities in common use in the Windows world for
creating installers.  Sometimes it will be obvious from the
installer's splash screen which one is in use; sometimes you can
figure it out by running <a
href="http://www.gnu.org/manual/binutils-2.12/html_node/binutils_9.html"
>strings</a>; and sometimes you just have to guess.

<p>Sure, you can run the installer with the <kbd>/?</kbd> switch to
learn which other switches it supports.  But if you really expect this
to work, then you have not been using Windows for very long.  By all
means, try it; in my experience, the odds are about 1 in 4 that
<kbd>/?</kbd> will tell you anything at all, even when there is
something to tell.

<h2 id="msi">MSI packages</h2>

<p>Microsoft's own <a
href="http://www.microsoft.com/windows2000/techinfo/howitworks/management/installer.asp">Windows
Installer Service</a> is the nominal standard, and if everybody used
it, there would be no need for this document.  Unfortunately,
Microsoft invented it too late.

<p>The package files have a <kbd>.msi</kbd> extension, and you
manipulate them using the <a
href="http://www.microsoft.com/TechNet/prodtechnol/winxppro/proddocs/msiexec.asp"
><kbd>msiexec</kbd></a> utility.

<p>For installation, use the <kbd>/i</kbd> and <kbd>/qb</kbd>
switches.  Use the <kbd>/l*</kbd> switch to produce a log file.  You
can provide named options ("properties") at the end of the command
line; which properties are supported depends on the package.  For
example, this command:

<pre>
    msiexec /qb /l* perl-log.txt /i ActivePerl.msi PERL_PATH=Yes PERL_EXT=Yes
</pre>

...is how you install ActiveState Perl, instructing the MSI package to
add Perl.exe to your PATH and to associate .pl files with it (<a
href="#activeperl">See below</a> for more on Perl).

<p><kbd>msiexec</kbd> can do many other things, like uninstall
software or apply patches to existing MSI files.  Neat, huh?  Too bad
nobody uses it.

<h2 id="installshield">InstallShield</h2>

<p><a href="http://www.installshield.com/">InstallShield</a> is one of
the oldest and most widely used application packaging utilities.

<p>Installers created by InstallShield recognize the <kbd>/r</kbd>,
<kbd>/s</kbd>, <kbd>/sms</kbd>, and <kbd>/f1</kbd> flags.

<p>To perform a "silent" installation, you need a <em>setup.iss</em>
file.  Some applications ship with such a file, but if not, you can
use the graphical installer itself to create one.

<p>Here is how it works.  Run the installer with the <kbd>/r</kbd>
("record") option.  Proceed through the dialogs and complete the
installation.  This will create a <em>setup.iss</em> file and place it
in the <em>C:\WINNT</em> directory (yes, really).  This file will
include all of your responses to the InstallShield dialogs, allowing
you to perform unattended installations as if you were giving the same
answers again.  Simply copy <em>setup.iss</em> to the same directory
as the installer executable.

<p>Once you have a <em>setup.iss</em> file, run the installer with the
<kbd>/s</kbd> ("silent") option.  This will perform an unattended
installation.

<p>Unfortunately, the installer will fork a separate process and exit,
meaning it will return immediately even if you run it under
<kbd>start&nbsp;/wait</kbd>.  This makes it useless for scripting
purposes.  Luckily, there is another switch, <kbd>/sms</kbd>, which
will cause the installer to pause until the installation completes.

<p>Hence, for an InstallShield application, you want to provide both
the <kbd>/s</kbd> and the <kbd>/sms</kbd> switches.

<p>The <kbd>/f1</kbd> switch allows you to specify a path to the
<em>setup.iss</em> file.  I assume this is to let you support multiple
answer files for a single application.

<p>Oh, one more thing.  The <kbd>/r</kbd> switch only works if the
release engineer is competent.  Many packages have "custom dialogs"
which are not supported by <em>setup.iss</em>, which means those
dialogs will always appear no matter what you do.  For such packages,
I suggest asking the vendor to fix their installer.  If that does not
work, I suggest doing what you can to help them go out of business.

<h2 id="wise">Wise InstallMaster</h2>

<p>InstallMaster from <a href="http://www.wise.com/">Wise
Solutions</a> is a competitor to InstallShield.  You can usually
identify the installers it produces by running "strings" on the
executable and grepping for "Wise".

<p>InstallMaster installers are supposed to recognize the
<kbd>/s</kbd> switch to perform a silent installation.  And in my
experience, they generally do.  There is no way to set options.

<p>NOTE: This product has been rebranded the "Wise Installation
System".  Don't let them confuse you.

<p>The Wise products can also "repackage" existing applications into
single executables supporting the <kbd>/s</kbd> option.  I do not
cover this here because I think it is a bad idea.

<h2 id="inno">Inno Setup</h2>

<p><a href="http://www.jrsoftware.org/isinfo.php">Inno Setup</a> is an
open source competitor in this space.  You can usually identify the
installers it creates by running "strings" on the executable and
grepping for "Inno".

<p>Inno Setup installers recognize the <kbd>/silent</kbd> option.

<h2>Microsoft packages</h2>

<p>Many packages (like hotfixes) which you can download from Microsoft
actually extract themselves to a temporary folder and then run a
command from inside that folder.  These packages often support the
<kbd>/t:<var>path</var></kbd> switch, to specify the temporary folder
name, and the <kbd>/c:<var>command</var></kbd> switch to specify the
command to run.  (Passing just <kbd>/c</kbd> suppresses running the
command at all.)

<p>See the "NOTE" in <a
href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;q317244"
>KB article Q317244</a> for an example.

<p>Most of these installers support the <kbd>/?</kbd> switch, which
will then claim to support <kbd>/q</kbd> for "quiet" operation and
<kbd>/r:n</kbd> to suppress the reboot, except when it's <kbd>/z</kbd>
to suppress the reboot.

<p>Leave it to Microsoft to make systems administration an <a
href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q69563"
>experimental science</a>.

<hr>

<h1>Specific applications</h1>

<h2 id="7-zip">7-zip</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a href="http://www.7-zip.org/">Open Source</a>
<tr><td valign="middle">Details

<td>

<p>As far as I know, <code>7-zip</code> is is the only open source
competitor to WinZip.  It uses its own self-extracting installation
scheme.

<p>For silent installation, run with options <code>-y&nbsp;/Q</code>.
Yes, that's "dash y slash Q", as described <a
href="http://sourceforge.net/tracker/?func=detail&atid=114481&aid=599673&group_id=14481">here</a>.

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/7-zip.pl?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >7-zip.pl</a>

</table>

<br><hr width="50%">
<h2 id="acrobat-reader">Acrobat Reader</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a href="http://www.adobe.com/products/acrobat/readstep.html">Free
Download</a>
<tr><td valign="middle">Details
<td><p>This one is tricky.

<p>Download the full installer package from Adobe.  Start it up.  It
will extract itself to a temporary folder in your profile, probably
somewhere like
<kbd>C:\Program&nbsp;Files\Documents&nbsp;and&nbsp;Settings\Administrator\Local&nbsp;Settings\Temp</kbd>.
But the installer will delete the temporary folder when it is
finished, so do
<b>not</b> complete the installation.  Instead, copy the temporary
folder somewhere else while the installer is running.

<p>This temporary folder is just a copy of the Acrobat Reader CD-ROM;
this is our installation tree.  From here, you can follow the
instructions in Adobe's <a
href="http://www.adobe.com/support/techdocs/2cc1e.htm">"Using a
setup.iss file for a Silent Installation of Acrobat Reader in
Windows"</a> document.  It is an <a href="#installshield"
>InstallShield</a> app.

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/acrobat-reader.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">acrobat-reader.bat</a>

</table>

<br><hr width="50%">
<h2 id="activeperl">ActiveState Perl (ActivePerl)</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a href="http://www.activestate.com/Products/ActivePerl/">Open Source</a>
<tr><td valign="middle">Details
<td><p>Just download the MSI file, which you <a href="#msi">already
know how to handle</a>.

<p>Most of the options are <a
href="http://aspn.activestate.com/ASPN/Perl/Reference/Products/ActivePerl/install.html#windows%20installers"
>documented</a>, except for <kbd>PERL_EXT</kbd>, which tells the
installer to make ActivePerl the default handler for .pl files.

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/perl.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">perl.bat</a>

</table>

<br><hr width="50%">
<h2 id="att-global-dialer">AT&amp;T Global Network Dialer</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><a href="http://help.attbusiness.net/">Free Download</a> (but
requires the service)

<tr><td valign="middle">Details

<td><p>The downloaded installer is named <kbd>ncsetup.exe</kbd>; you
probably want to rename it to <kbd>att-5.0.5.exe</kbd> or somesuch.
Running "strings" on the executable reveals that it was created by <a
href="#wise">Wise Installmaster</a>, so the <kbd>/s</kbd> flag will do
the trick.

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/att.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">att.bat</a>

</table>

<br><hr width="50%">
<h2 id="directx">DirectX 8.1</h2>
<table border cellpadding=4>
<tr><td valign="middle">Availability
<td><a
href="http://www.microsoft.com/windows/directx/downloads/drx81.asp"
>Free Download</a>
<tr><td valign="middle">Details

<td><p>The downloaded installer is named DX81NTeng.exe.  Run
<kbd>DX81NTeng.exe&nbsp;/c&nbsp;/t:<var>path</var></kbd> to extract
the tree to <var>path</var>.  From that tree, run
<kbd>dxsetup&nbsp;/silent&nbsp;/install</kbd>.

<tr><td valign="middle">Example
<td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/directx81.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">directx81.bat</a>

</table>

<br><hr width="50%">
<h2 id="lotus-notes">Lotus Notes (technically IBM/Lotus, but who cares)</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability

<td>The software is a <a href="http://www.lotus.com/">commercial
product</a>; the incremental update installers <a
href="http://www.lotus.com/ldd/down.nsf">are available for
download</a>.

<tr><td valign="middle">Details

<td><p>The master <code>setup.exe</code> is just an <a
href="http:#installshield">InstallShield</a> executable.  Use the
<code>/s&nbsp;/sms</code> (and perhaps the <code>/f1</code>) switches.

<p>The incremental installers, on the other hand, respond to
<code>/?</code>.  For unattended installation, provide the
<code>/nouser</code> switch.  Note that each incremental installer
only works for the immediately preceeding version of notes, so you
must apply each of them in order.

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/notes.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >notes.bat</a>

</table>

<br><hr width="50%">
<h2 id="mdac">MDAC (Microsoft Data Access Components)</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><a href="http://www.microsoft.com/data/download.htm">Free Download</a>

<tr><td valign="middle">Details

<td><p>Typical random Microsoft package.  For unattended install, run
with <code>/q&nbsp;/c:"setup&nbsp;/qn1"</code>.

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/mdac.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >mdac.bat</a>

</table>

<br><hr width="50%">
<h2 id="office">Microsoft Office</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><a href="http://www.microsoft.com/office/">Commercial</a>

<tr><td valign="middle">Details

<td><p>This is another fun one.

<p>To perform unattended installations of Office, you need to create
what Microsoft calls an <a
href="http://www.microsoft.com/office/ork/2000/two/45ct_3.htm"
>"Administrative Installation Point"</a>.  This is basically a copy of
the CD, modified to already contain your license key and organization
name.  To create the Administrative Installation Point, run:

<pre>
    setup.exe /a data1.msi
</pre>

<p>The <code>data1.msi</code> file is at the top-level of the CD-ROM.

<p>You will surely want to apply Microsoft's updates, as well.  You
can keep up with them by reading Microsoft's <a
href="http://www.microsoft.com/office/ork/xp/journ/adminup.htm"
>Administrative Updates Journal</a>.  Note that some updates are not
released with an "administrative" version; for such updates, you will
need to apply them after the installation of Office completes.

<p>Once that is finished, you can install Office using the
<code>data1.msi</code> package from the Administrative Installation
Point just like any other <a href="#msi">MSI</a> package.  There are
many public properties you can use, as documented in <a
href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q270920">KB
article Q270920</a> (although a better description can be found in the
setupref.xls spreadsheet from the <a
href="http://www.microsoft.com/office/ork/2000/appndx/toolbox.htm#offinfo"
>Office Information</a> part of the Office Resource Kit toolbox.)  I
happen to like the settings <code>ADDLOCAL=ALL</code>,
<code>REBOOT=ReallySuppress</code>, <code>NOUSERNAME=TRUE</code>,
<code>ALLUSERS=1</code>, and <code>DISABLEMEDIA=1</code>.  Your
mileage may vary.

<p>Note: To create an Administrative Installation Point, you must be
using the Retail or Enterprise editions of Office 2000 (not OEM).  For
Office XP, only the Enterprise edition will do.  If you try to use the
OEM edition, the process will appear to work, but it will actually
just scribble uselessly over the root directory of the current drive.
(Hint: You can bypass this behavior by using the Office Resource Kit
to create a <em>transform file</em> which changes the
<code>OEMRelease<code> property from 1 to 0, but you did not hear this
from me.)

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/office.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >office.bat</a>

</table>

<br><hr width="50%">
<h2 id="mozilla">Mozilla</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><a href="http://www.mozilla.org/">Open Source</a>

<tr><td valign="middle">Details

<td>For unattended install, run with <code>-ma</code> option.  (Is
this documented somewhere?)

<tr><td valign="middle">Example
<td><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/mozilla.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >mozilla.bat</a>

</table>

<br><hr width="50%">
<h2 id="support-tools">Windows 2000 Support Tools</h2>
<table border cellpadding=4>

<tr><td valign="middle">Availability
<td><a
href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp3/supporttools.asp"
>Free Download</a>

<tr><td valign="middle">Details

<td><p>Run the installer with the <code>/X</code> switch (figured out
by running "strings").  The installer will prompt for a directory to
which it will extract the tree.  Inside the tree will be an <a
href="#msi">MSI</a> file named <code>2000rkst.msi</code>.

<tr><td valign="middle">Example <td><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/scripts/support-tools.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>support-tools.bat</a>

</table>

<hr>
<address>
Patrick J. LoPresti <a
href="mailto:patl@users.sourceforge.net">patl@users.sourceforge.net</a>
</address>

<A href="http://sourceforge.net"> <IMG align="right"
src="http://sourceforge.net/sflogo.php?group_id=62053&amp;type=5"
width="210" height="62" border="0" alt="SourceForge Logo"></A>

</body>
</html>
