<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Unattended, A Windows deployment system: The OS</title>
</head>
<body>

<p>This document is part of <a
href="http://unattended.sourceforge.net/" >Unattended, a Windows
deployment system</a>.

<hr>
<h1>Overview</h1>

To perform an unattended installation of Windows NT, 2000, or XP, you
need to:

<ol>
<li><a href="#install-share">Create the OS distribution point</a>
(basically, a folder holding a copy of the Windows CD-ROM)

<li><a href="#bootdisk">Create the DOS network boot disk</a>

<li><a href="#go">Boot from it</a>, answer a bunch of questions, and
go get a snack while the OS installs itself

</ol>

<h1 id="install-share">Create the OS distribution point</h1>

<p>In principle, the OS distribution point could be a CD-ROM or a
local disk directory, but we are going to use a network share.

<h2>Create the install share (Z: drive)</h2>
<p>Copy the <code>install</code> directory tree from this distribution
to a Windows file server (or a Unix box running <a
href="http://www.samba.org/">Samba</a>), and export it read-only with
guest access permitted.  The bootdisk will ask you for the full
Windows name of this share; the default is
<code>\\ntinstall\install</code>.  The boot disk maps this share as
the <code>Z:</code> drive, and this is how we will refer to it from
now on.

<p>This procedure relies on the following files and directories from
the <code>Z:</code> drive:

<dl>

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/djgpp/"
>djgpp</a>

<dd>Contains parts of <a
href="http://www.delorie.com/djgpp/">DJGPP</a>, a collection of Unix
tools for DOS.  This one is too big to bundle, so you will need to
download it yourself; <a href="#djgpp">see below</a> for instructions.
(Is it really worth it just so we can use a Bourne shell script
instead of a <code>.bat</code> file?  Yes, it is.)

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/dosbin/"
>dosbin</a>

<dd>Directory containing DOS utility programs (like fdisk) from the <a
href="http://www.freedos.org/">FreeDOS</a> project.

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/install.sh?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>install.sh</a>

<dd>Shell script run by <code>autoexec.bat</code> on the bootdisk.
This is the first entry point to the networked portion of the
installation.  This script will ask you a bunch of questions, then
start the actual unattended installation.  You may need to edit this
script slightly for your site.

<dt><a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/unattend.txt?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup" >unattend.txt</a>

<dd>Prototype answer file.  The <code>install.sh</code> script will
copy this to your local drive and let you edit it.  <a
href="#answer-file">See below</a> for more information.

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/win2k/"
>win2k</a>

<dd>Directory holding a copy of the <code>i386</code> folder from a
Windows 2000 CD-ROM.  You will need to populate this if you want to
install Win2k (as <a href="#cd-rom">described below</a>).

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/win2ksp3/"
>win2ksp3</a>

<dd>Just like <code>win2k</code>, but with Service Pack 3 already
integrated (also <a href="#service-pack">described below</a>).

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/winxp/"
>winxp</a>

<dd>Similarly, but for Windows XP.

<dt><a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/winxpsp1/"
>winxpsp1</a>

<dd>Similarly, but for Windows XP with integrated Service Pack 1.

</dl>

<h2 id="djgpp">Download DJGPP</h2>

<p><a href="http://www.delorie.com/djgpp/">DJGPP</a> is a port of the
Unix environment to DOS.  You will need to download the following
components:

<ul>
<li>The basic development kit (<a
href="ftp://ftp.simtel.net/pub/simtelnet/gnu/djgpp/v2/djdev203.zip"
>v2/djdev203.zip</a>)

<li>The DPMI server (<a
href="ftp://ftp.simtel.net/pub/simtelnet/gnu/djgpp/v2misc/csdpmi5b.zip"
>v2misc/csdpmi5b.zip</a>)

<li>The Bash port (<a
href="ftp://ftp.simtel.net/pub/simtelnet/gnu/djgpp/v2gnu/bsh204b.zip"
>v2gnu/bsh204b.zip</a>)

</ul>

<p>Just unzip all of them under <code>Z:\djgpp</code>.

<h2 id="cd-rom">Copy the Windows CD-ROM to the share</h2>
<p>Copy the <code>i386</code> folder from your Windows CD-ROM to the
appropriate subdirectory of the <code>install</code> share.  For
example, for Windows XP, copy the <code>i386</code> folder to
<code>Z:\winxp</code> (thus creating <code>Z:\winxp\i386</code>).

<h3 id="service-pack">Integrate the service pack (optional)</h3>

<p>This step is optional; you can apply a service pack just like you
apply any other hotfix later.  But combining the service pack into the
distribution point now will make installation faster.

<p>To apply the service pack to the installation point, use the
"slipstreaming" feature introduced in Windows 2000 Service Pack 1
(i.e., not supported by NT).  You can find details in Microsoft's <a
href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp3/spdeploy.htm"
><em>Windows 2000 Service Pack 3 Installation and Deployment
Guide</em></a> or <a
href="http://www.microsoft.com/WindowsXP/pro/downloads/servicepacks/sp1/spdeploy.asp"
>Windows XP Service Pack 1 Installation and Deployment Guide</a>.

<p>The process is the same for Windows 2000 and XP.  Using Windows XP
Service Pack 1 as an example:

<ol>

<li>Copy or rename <code>Z:\winxp</code> to <code>Z:\winxpsp1</code>.
This name is not accurate yet, but it will be in a few minutes.

<li>Download <a
href="http://www.microsoft.com/WindowsXP/pro/downloads/servicepacks/sp1/network.asp"
>the service pack (network installation)</a> from Microsoft. This will
be a package file, say <code>xpsp1_en_x86.exe</code>.

<li>Run
<pre>
    xpsp1_en_x86.exe /u /x:c:\xpsp1
</pre>

<p>This will extract the service pack files to the folder
<code>c:\xpsp1</code>.  Any folder will do.

<li>Run
<pre>
    c:\xpsp1\i386\update\update.exe /s:Z:\winxpsp1
</pre>

<p>This applies the service pack to the distribution point
<code>Z:\winxpsp1</code>, creating an integrated ("slipstreamed")
WinXP SP1 tree.  Due to a bug, you must be a local administrator for
this command to work, even if you have write access to the target
folder.  Also, you must be running XP to use the XP service pack
installer.

</ol>

<h3 id="drivers">Add device drivers</h3>

<p>This step may be optional, depending on your hardware and which
version of Windows you are trying to install.  Each release of Windows
generally ships with a fairly large collection of drivers, supporting
most of the hardware which was current at the time.  However, if you
are installing, say, Windows 2000 on a recent system (especially a
laptop), you may find that it does not support some or all of your
hardware.

<p>You can add the device drivers later, of course.  But if you want
to automate both OS and application installation, and your version of
Windows lacks built-in support for your network card, you will need to
provide proper network drivers on the OS distribution point.  Here is
how to do it.

<p>First, download the driver package from the hardware vendor and
expand it.  There should be a collection of <code>.inf</code> files in
the top-level directory; that is the directory you need to copy to the
OS distribution share.

<p>To where should you copy it?  That is a long story...

<p>Under the <code>i386</code> folder on the distribution point,
create a folder named <code>$oem$</code>.  Under <b>that</b> folder,
create a folder named <code>$1</code>.  (Yes, really.)  Windows Setup
will copy everything below the <code>$1</code> folder to the
<code>C:</code> drive during installation.

<p>You may put the driver folder anywhere you like under the
<code>$1</code> directory, as long as you add it to
<code>OemPnPDriversPath</code> in the <a
href="#answer-file"><code>unattend.txt</code></a> file.

<p>For example, at my site we have a folder named
<code>Z:\win2ksp3\i386\$oem$\$1\drivers\net\IntelPRO</code> which
holds the Intel&nbsp;Pro/100 network family drivers, and we have a
folder named <code>Z:\win2ksp3\i386\$oem$\$1\drivers\video\T22</code>
which holds the video drivers for the IBM ThinkPad T22 laptop.  Both
of these paths, starting with <code>drivers/</code> level, appear in
<code>OemPnPDriversPath</code> in our <code>unattend.txt</code> file.

<h1 id="bootdisk">Create the bootdisk</h1>

<p>The goal here is very simple: To boot to DOS so we can mount the
<code>install</code> share as the <code>Z:</code> drive and run the
<code>Z:\install.sh</code> script.  There are three ways to do this:
By booting from a floppy, by booting from a CD-ROM, or by booting
directly from the network.

<p>The <code>bootdisk</code> directory from this distribution holds
the disk images and the tools needed to re-create them.  Please
<kbd>cd</kbd> there for the rest of this section.

<h2>Booting from a floppy</h2>

<p>The <code>images</code> subdirectory holds one 1.44M floppy disk
image for each supported network driver.  The <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/DRIVERS.txt?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>DRIVERS.txt</a> file describes the supported drivers.  The driver
names are a little weird because each is derived from the
corresponding DOS network driver filename.

<p>You need to use the floppy image with the right driver for your
network card.  If you are not sure which driver is right, you may need
to try them all.  (See below about <a href="#netboot">booting directly
from the network</a>, in which case this is not an issue.)

<p>Once you have chosen the correct floppy image for your network
card, you will need to write it to a floppy.  How you do this depends
on your operating system.

<p>For Linux, a command like
<kbd>dd&nbsp;if=images/e100b.img&nbsp;of=/dev/fd0</kbd> will do the
trick.

<p>For Windows, you will need to download a <a
href="http://www.fdos.org/ripcord/rawrite/readme.html#windows">rawrite
utility</a>.  They say <a
href="http://uranus.it.swin.edu.au/~jn/linux/rawwrite.htm">rawwritewin</a>
has a nice GUI.

<h2>Booting from CD-ROM</h2>

<p>This section is optional; you can kick off the installation process
just using a floppy.  But this is faster, and <b>all</b> of the floppy
images fit on a single CD-ROM.

<p>The <code>bootdisk.iso</code> file is an ISO-9660 image of a
bootable CD-ROM.  Simply burn it to a CD, which you can do with just
about any CD recording utility.  Consult your utility's documentation
and search for <code>ISO-9660</code> or just <code>ISO</code>.

<p>When you boot from the CD-ROM, you will be offered a choice of
"virtual floppies" to load, consisting of exactly the images found in
the <code>images</code> directory and the <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/DRIVERS.txt?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>DRIVERS.txt</a> file.  Choose the correct image for your network
card.

<h2 id="netboot">Booting from the network</h2>

<p>This section is also optional, although all-network installs really
are the most fun.  They do require the most support from the network
infrastructure, however.

<p>First, you will need a TFTP server.  Copy the files and folders
from the <code>tftpboot</code> directory to the TFTP server's root
directory.  <a href="http://tftpd32.jounin.net/">Tftpd32</a> is a good
TFTP server for Windows, and it might even work for this.  [Editor's
note: Contributions to this section are welcome.]

<p>Second, you will need to configure your DHCP server.  Most modern
network cards support booting directly from the network following
Intel's <em>Preboot eXecution Environment</em> (PXE) specification.
If you are a masochist, you can download the PXE specification from <a
href="http://www.intel.com/labs/manage/wfm/wfmspecs.htm">Intel's WFM
site</a>.  But the basic idea is pretty simple: Just configure your
DHCP server to provide <em>filename</em> and <em>next-server</em> DHCP
options naming the TFTP server and <code>pxelinux.0</code>,
respectively.  Do not let the name fool you; <code>pxelinux.0</code>
has nothing to do with Linux.  It comes from the <a
href="http://syslinux.zytor.com/">SYSLINUX</a> package, an excellent
general-purpose boot loader.

<p>Once you have configured your TFTP and DHCP servers, you are ready
to boot machines from the network.  Actually convincing a machine to
do this can take some work.  Many network cards have a BIOS of their
own which you must use to enable booting via PXE.  For systems with
integrated network hardware, the system BIOS itself may have a
configuration option called "Enable on-board network" with
<b>three</b> settings: "On", "Off", and "On w/ PXE".

<p>NOTE: Historically (meaning as recently as 2002), many vendors' PXE
implementations were extremely buggy.  Always flash the firmware on
your network card to the latest version before attempting a network
boot.  For network hardware embedded on a motherboard or laptop, this
probably means flashing the system BIOS.

<p>Once you have enabled PXE in the network card BIOS, reboot the
machine and enter the system BIOS again. Examine the "boot order"
option.  There should be a new entry, with a name like "MBA slot 0" or
"IBA slot 3".  (Note that many BIOSes have a "Network" option here
which may <b>not</b> be what you want.)  Configure the network boot
device ahead of the hard disk, and you should be good to go.

<p>Some systems, like the Dell PowerEdge and Optiplex series, will
respond to <kbd>F12</kbd> during power-up to initiate a network boot.
This is convenient if you only want to boot from the network once or
twice to kick off the OS installation, but you want most boots to be
from the hard drive.

<p>If all else fails, contact your vendor and ask them how to perform
a PXE network boot.  If they say you cannot, stick your tongue at them
and use a floppy or CD-ROM instead.

<p>One great feature of booting from the network is that you do
<b>not</b> need to choose the network driver for your card (!).  3com
has kindly written a "universal" DOS network driver which works on top
of any PXE implementation, allowing one floppy image to support any
PXE-compatible network device.

<h2>Modifying the boot disk</h2>

<p>This section is <b>definitely</b> optional.  If it makes no sense
to you, just skip it.

<p>Modifying the bootdisk requires a Unix box with the appropriate
utilities installed.  Basic utilities like GNU Make go without saying.
But to update the floppy disk images, you will also need the <a
href="http://mtools.linux.lu/">Mtools</a> suite.  To update the ISO
image, you will need the <a
href="http://www.andante.org/mkisofs.html">mkisofs</a> utility.

<p>In the <code>bootdisk</code> directory, typing
<kbd>make&nbsp;images</kbd> will generate the floppy disk images.
Typing <kbd>make&nbsp;iso</kbd> will create the ISO image.  Typing
<kbd>make&nbsp;tftpboot</kbd> will populate the <code>tftpboot</code>
directory.  And simply typing <kbd>make</kbd> will do all these.

<p>The <code>DRIVERS.txt</code> file and <code>drivers</code>
directory define the supported network drivers.  To add a new driver,
put it in the <code>drivers</code> directory, update
<code>DRIVERS.txt</code>, and type <kbd>make</kbd>.

<p>The <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/template"
><code>template</code></a> subdirectory contains the files on the boot
disk itself.  For example, if you want to change <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/template/autoexec.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>autoexec.bat</a> or <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/template/config.sys?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>config.sys</a>, just edit them under <code>template</code> and run
<kbd>make</kbd>.  (Most of the binaries on the bootdisk are just
Microsoft's <a href="ftp://ftp.microsoft.com/bussys/Clients/MSCLIENT/"
>MSCLIENT</a> distribution.  The exceptions are
<code>random.com</code> and <code>nset.com</code>, very handy
utilities from <a
href="http://home.mnet-online.de/horst.muc/horst.htm">Horst
Schaeffer's nice collection</a>.)

<p>The CD-ROM boot loader is <a
href="http://syslinux.zytor.com/iso.php">ISOLINUX</a> from the <a
href="http://syslinux.zytor.com/">SYSLINUX</a> package.  We use <a
href="http://syslinux.zytor.com/memdisk.php">memdisk</a>, also from
SYSLINUX, to allow us to chain-boot to a "virtual floppy".

<p>The PXE boot loader is <a href="http://syslinux.zytor.com/pxe.php"
>PXELINUX</a>, also from the <a href="http://syslinux.zytor.com/"
>SYSLINUX</a> package.  It also uses <a
href="http://syslinux.zytor.com/memdisk.php">memdisk</a> to boot from
a "virtual floppy", this time directly over the network.  The
universal DOS network driver is <code>undis3c.dos</code> from 3com's
<a href="http://support.3com.com/infodeli/tools/nic/mba.htm" >MBA
Utility disk</a>.


<h1 id="go">Boot the bootdisk</h1>

<p>(Note: The bootdisk uses DHCP to obtain an IP address.  You
probably already have a DHCP server on your network, but if you do
not, you will need to modify the bootdisk's <code>system.ini</code>
and <code>protocol.ini</code> files to use a static IP address.  This
task is beyond the scope of this document; I suggest you set up a DHCP
server instead.)

<p>The bootdisk's entire purpose in life is to obtain access to the
network, then hand off control to the more powerful tools available
there.  In particular, the bootdisk mounts the <code>install</code>
share as the <code>Z:</code> drive, then executes the Bourne shell
script <code>Z:\install.sh</code>.  This script will help you perform
several preparatory tasks and then launch the OS installer.

<p>Follow along in <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/bootdisk/template/autoexec.bat?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>autoexec.bat</a> if you like.

<h2>Mounting <code>Z:</code></h2>

<p>After loading the network stack, the boot disk runs
<code>net&nbsp;start&nbsp;basic</code>.  This will prompt you for a
user name, password, and whether you want to save the password in your
"password list".  (Since ramdisks are volatile, this last option is
useless, but I have been unable to figure out how to suppress it.)  If
your <code>install</code> share is exported with "guest" access
allowed, you can simply press <kbd>Enter</kbd> three times here.  If
the share does not allow guest access, you may provide any valid user
name and password to map the share.  You will then be able to install
the operating system, but you may have problems when the process moves
on to installing the applications, because that requires mapping the
<code>Z:</code> drive from Windows.  All in all, you are probably best
off permitting (read-only) guest access to the <code>install</code>
share.

<p>Next, the bootdisk asks you for the name of the install share and
runs <code>net&nbsp;use&nbsp;Z:&nbsp;<var>share</var></code> to map
it.

<p>Finally, the bootdisk passes control to the <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/install.sh?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
><code>Z:\install.sh</code></a>script.  Once again, feel free to
follow along by reading the script.

<h2>Partitioning and formatting</h2>

<p>The <code>install.sh</code> script begins by helping you partition
and format the drive.

<p>The partition table must have a small (< 2G) FAT partition for the
<code>C:</code> drive.  Do not worry; Windows Setup will later expand
the partition to take up any adjacent free space, and it will convert
the partition to NTFS.

<p>The menu will offer to partition the disk automatically using a few
layouts which I like.  You can partition the disk manually.  Either
way, you will reboot the machine to let the BIOS notice any partition
table changes.

<p>Once you have a small FAT partition as the <code>C:</code> drive,
you need to format it; just select that option from the menu.

<h2>Choosing the operating system</h2>

<p>Next, <code>install.sh</code> will ask you which operating system
you want to install.  If you do not see the one you want, send me a
feature request (or add it yourself and send me a patch).

<h2>Choosing the application suite</h2>

<p>Next, <code>install.sh</code> will ask you which script to run (if
any) after the OS installation is finished.  This is the hook to start
the automated application installation process.  The scripts are found
in the <code>Z:\scripts</code> share, as is discussed in the <a
href="apps.html">application installation</a> portion of this
documentation.

<p>Next, <code>install.sh</code> will create
<code>C:\netinst\toplev.bat</code>, which is what the
<code>unattend.txt</code> file names as the script to run when OS
installation is finished.

<h2 id="answer-file">Editing unattend.txt</h2>

<p>Finally, <code>install.sh</code> will copy the sample <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/unattend.txt?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
><code>z:\unattend.txt</code></a> file to the <code>c:\netinst</code>
directory and let you edit it.

<p>The <code>unattend.txt</code> file, also known as the "answer
file", is the key to the whole process.  Normally, <em>Windows
Setup</em> tosses up lots of dialogs to ask you questions like, "What
is your name?", "What is your license key?", and so on.  By passing
the right flags to the installer (<code>i386\winnt.exe</code>), we
will cause <em>Windows Setup</em> to consult this file for the answers
instead.

<a name="guide"></a>
<p>The best documentation for the answer file is Microsoft's own, but
unfortunately, it is a bit annoying to obtain.  There are different
versions both for Windows 2000 and for Windows XP, although the answer
files are very similar.

<dl>
<dt><em>Windows 2000 Guide to Unattended Setup</em>

<dd>Unfortunately, as far as I know, you cannot download this document
directly; you must first download and install the <a
href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp3/supporttools.asp"
>Windows 2000 SP3 Support Tools</a>, then use Internet Explorer to
extract the <code>unattend.doc</code> file from the
<code>deploy.cab</code> archive.  You can also find
<code>deploy.cab</code> on the Windows 2000 CD in the
<code>support\tools</code> folder.

<dt><em>Microsoft Windows Preinstallation Reference</em>

<dd>This document is also unavailable for direct download.  You must
first download the <a
href="http://www.microsoft.com/WindowsXP/pro/downloads/servicepacks/sp1/deploytools.asp"
>Windows XP SP1 Corporate Deployment Tools</a>, also known as
<code>deploy.cab</code>.  Then use Internet Explorer to extract
<code>ref.chm</code>, a Windows Help file.
</dl>

<p>(Personally, I find the Windows 2000 Word document easier to read.)

<p>Once you understand it, editing <code>unattend.txt</code> is pretty
easy.  And you certainly will want to edit it, because the template is
not going to have the correct organization name, domain, or (heh)
license key.

<p>Most lines are simple <em>variable = value</em> pairs.  Lines
starting with ; are comments.  If you fail to provide a required
variable, like <em>ProductKey</em>, the installation will stop at some
point to throw up a dialog and ask for it.

<p>The keys you will most likely want to edit include:

<dl>
<dt><em>FullName</em>
<dd>The full name of the user of this computer.  The actual value is
not very important.

<dt><em>OrgName</em>
<dd>Similarly.

<dt><em>ComputerName</em>
<dd>The name of the computer.  A value of "*" tells the Windows Setup
to pick a random name.

<dt><em>ProductKey</em>
<dd>Your 25-character Windows XP software license key, just as it
appears on your license.  For Windows 2000, this variable is named
<em>ProductID</em>.

<dt><em>AdminPassword</em>
<dd>The password for the local Administrator account.

<dt><em>TimeZone</em>

<dd>The time zone setting.  This must be a <b>numeric</b> value.  For
example, <code>35</code> means "U.S. Eastern" and <code>4</code> means
"Pacific".  The <a href="#guide">Guide to Unattended Setup</a> has a
complete list.

<dt><em>AutoLogon</em>

<dd>If set to "yes", Setup will patch the registry to logon
automatically as Administrator, skipping the logon screen, at every
reboot.  This setting is useful for automatically doing other things
once the OS install is done. (You can use the <a
href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/unattended/unattended/install/bin/autolog.pl?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup"
>autolog.pl</a> script in <code>Z:\bin</code> to enable or disable
this registry setting after the OS is installed.)

<dt><em>JoinDomain</em>
<dd>If present, tells Setup to join this computer to a domain.

<dt><em>DomainAdmin, DomainAdminPassword</em>

<dd>These work in conjunction with <em>JoinDomain</em>.  They specify
the domain account and password to use to join the computer to the
domain.  Note that <em>DomainAdmin</em> must be in fully-specified
(<code>DOMAIN\user</code>) form.

<dt>OemPnpDriversPath

<dd>Specifies additions to the search path for Plug&amp;Play drivers.
Elements of this path are separated by semicolons.  Windows uses this
path when searching for a driver for a piece of hardware.  These paths
are relative to the <code>C:</code> drive, and are usually used in
conjunction with the <a href="#drivers"><code>$oem$/$1</code></a>
mechanism.

</dl>

<p>These are just a few of the important keys; for a complete list,
consult the <a href="#guide"><em>Guide to Unattended Setup</em></a>.

<p>Note that if you have standard settings for these keys at your
site, you can edit the prototype <code>Z:\unattend.txt</code> on the
file server so that you do not need to edit them for every
installation.


<h2>Firing it off</h2>

<p>Once you have edited <code>unattend.txt</code>, select the
"proceed" option.  This will run <code>i386\winnt.exe</code> from the
OS distribution point with the proper options to perform an unattended
installation.

<p>And that's it; your OS installation should be on its way.  You
probably want to automate <a href="apps.html">installing the
applications</a> next.

<hr>
<address>
Patrick J. LoPresti <a
href="mailto:patl@users.sourceforge.net">patl@users.sourceforge.net</a>
</address>

<A href="http://sourceforge.net/"> <IMG align="right"
src="http://sourceforge.net/sflogo.php?group_id=62053&amp;type=5"
width="210" height="62" border="0" alt="SourceForge Logo"></A>

</body>
</html>
